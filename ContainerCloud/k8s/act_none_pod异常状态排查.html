<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.12" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.47" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://www.bugcode.online/ContainerCloud/k8s/act_none_pod%E5%BC%82%E5%B8%B8%E7%8A%B6%E6%80%81%E6%8E%92%E6%9F%A5.html"><meta property="og:site_name" content="bugcode çš„æ¶æ„ä¹‹è·¯"><meta property="og:title" content="2ã€Podå¼‚å¸¸çŠ¶æ€æ’é”™"><meta property="og:description" content="2ã€Podå¼‚å¸¸çŠ¶æ€æ’é”™ ä¸€ã€å¸¸ç”¨å‘½ä»¤ é¦–å…ˆåˆ—å‡ºPodæ’æŸ¥è¿‡ç¨‹ä¸­æˆ‘è¿™è¾¹çš„å¸¸ç”¨å‘½ä»¤ï¼š æŸ¥çœ‹PodçŠ¶æ€ï¼škubectl get pod podname -o wide æŸ¥çœ‹Podçš„yamlé…ç½®ï¼škubectl get pods podname -o yaml æŸ¥çœ‹podäº‹ä»¶ï¼škubectl describe pods podname æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼škubec..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-08-12T08:08:43.000Z"><meta property="article:author" content="bugcode"><meta property="article:tag" content="DOCKER"><meta property="article:tag" content="äº‘åŸç”Ÿ"><meta property="article:tag" content="K8S"><meta property="article:published_time" content="2020-01-01T00:00:00.000Z"><meta property="article:modified_time" content="2024-08-12T08:08:43.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"2ã€Podå¼‚å¸¸çŠ¶æ€æ’é”™","image":[""],"datePublished":"2020-01-01T00:00:00.000Z","dateModified":"2024-08-12T08:08:43.000Z","author":[{"@type":"Person","name":"bugcode"}]}</script><meta name="robots" content="all"><meta name="author" content="bugcode"><meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Expires" content="0"><meta name="keywords" content="Java, JavaåŸºç¡€, å¹¶å‘ç¼–ç¨‹, JVM, è™šæ‹Ÿæœº, æ•°æ®åº“, MySQL, Spring, Redis, MyBatis, SpringBoot, IDEA, æ±‚èŒé¢è¯•, é¢æ¸£é€†è¢­, å­¦ä¹ è·¯çº¿"><meta name="apple-mobile-web-app-capable" content="yes"><script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?5230ac143650bf5eb3c14f3fb9b1d3ec";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
      </script><link rel="stylesheet" href="//at.alicdn.com/t/c/font_4570931_i3acfllzyt.css"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><title>2ã€Podå¼‚å¸¸çŠ¶æ€æ’é”™ | bugcode çš„æ¶æ„ä¹‹è·¯</title><meta name="description" content="2ã€Podå¼‚å¸¸çŠ¶æ€æ’é”™ ä¸€ã€å¸¸ç”¨å‘½ä»¤ é¦–å…ˆåˆ—å‡ºPodæ’æŸ¥è¿‡ç¨‹ä¸­æˆ‘è¿™è¾¹çš„å¸¸ç”¨å‘½ä»¤ï¼š æŸ¥çœ‹PodçŠ¶æ€ï¼škubectl get pod podname -o wide æŸ¥çœ‹Podçš„yamlé…ç½®ï¼škubectl get pods podname -o yaml æŸ¥çœ‹podäº‹ä»¶ï¼škubectl describe pods podname æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼škubec...">
    <link rel="stylesheet" href="/assets/css/styles.6b04e72b.css">
    <link rel="preload" href="/assets/js/runtime~app.9637422e.js" as="script"><link rel="preload" href="/assets/css/styles.6b04e72b.css" as="style"><link rel="preload" href="/assets/js/9547.c8ff98a9.js" as="script"><link rel="preload" href="/assets/js/app.03f81d61.js" as="script">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="https://vscodepic.oss-cn-beijing.aliyuncs.com/blog/log.jpg" alt><!----><span class="vp-site-name hide-in-pad">bugcode çš„æ¶æ„ä¹‹è·¯</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="ä¸»é¡µ"><!--[--><span class="font-icon icon iconfont icon-home" style=""></span><!--]-->ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/introduction/" aria-label="å¯¼è¯»"><!--[--><span class="font-icon icon iconfont icon-book" style=""></span><!--]-->å¯¼è¯»<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="ç®—æ³•"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span>ç®—æ³•<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/algorithm/algor/" aria-label="ç®—æ³•ä¸“é¢˜"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span><!--]-->ç®—æ³•ä¸“é¢˜<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/algorithm/dataStructure/" aria-label="æ•°æ®ç»“æ„ä¸“é¢˜"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span><!--]-->æ•°æ®ç»“æ„ä¸“é¢˜<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="è®¾è®¡æ¨¡å¼"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span>è®¾è®¡æ¨¡å¼<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/designpattern/designPrinciple/" aria-label="è®¾è®¡åŸåˆ™"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span><!--]-->è®¾è®¡åŸåˆ™<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/designpattern/creational/" aria-label="åˆ›å»ºå‹"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span><!--]-->åˆ›å»ºå‹<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/designpattern/Behavior/" aria-label="è¡Œä¸ºå‹"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span><!--]-->è¡Œä¸ºå‹<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/designpattern/structural/" aria-label="ç»“æ„å‹"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span><!--]-->ç»“æ„å‹<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æºç "><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span>æºç <!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/frameDesignAndSourceCode/springSourceCode/" aria-label="Springæºç å®ç°"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span><!--]-->Springæºç å®ç°<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/frameDesignAndSourceCode/mybatisSourceCode/" aria-label="Mybatisæ¡†æ¶å®ç°"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span><!--]-->Mybatisæ¡†æ¶å®ç°<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ¶æ„ä¸“é¢˜"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span>æ¶æ„ä¸“é¢˜<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/engineeringArchitectureDesign/" aria-label="MVCå’ŒDDD"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span><!--]-->MVCå’ŒDDD<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="ç²¾é€‰åšæ–‡"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span>ç²¾é€‰åšæ–‡<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">ä¸šåŠ¡çŸ¥è¯†</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/excellentBook/business/" aria-label="é‡‘èä¸šåŠ¡"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span><!--]-->é‡‘èä¸šåŠ¡<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">é¡¹ç›®ç»éªŒ</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/excellentBook/project/" aria-label="K8Séƒ¨ç½²é¡¹ç›®"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span><!--]-->K8Séƒ¨ç½²é¡¹ç›®<!----></a></li></ul></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/excellentBook/" aria-label="é€šç”¨æ•°æ®è®¾è®¡"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span><!--]-->é€šç”¨æ•°æ®è®¾è®¡<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/excellentBook/scence.html" aria-label="ä¸šåŠ¡åœºæ™¯è®¾è®¡"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span><!--]-->ä¸šåŠ¡åœºæ™¯è®¾è®¡<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/home.html" aria-label="åŸºç¡€å½’æ¡£"><!--[--><span class="font-icon icon iconfont icon-gaishu" style=""></span><!--]-->åŸºç¡€å½’æ¡£<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/interview/k8s/" aria-label="é¢è¯•ç¯‡"><!--[--><span class="font-icon icon iconfont icon-gaishu" style=""></span><!--]-->é¢è¯•ç¯‡<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/KnowledgePlanet/" aria-label="çŸ¥è¯†æ˜Ÿçƒ"><!--[--><span class="font-icon icon iconfont icon-gaishu" style=""></span><!--]-->çŸ¥è¯†æ˜Ÿçƒ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/KnowledgePlanet/" aria-label="Bç«™"><!--[--><span class="font-icon icon iconfont icon-gaishu" style=""></span><!--]-->Bç«™<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/about/" aria-label="å…³äºæˆ‘"><!--[--><span class="font-icon icon iconfont icon-book" style=""></span><!--]-->å…³äºæˆ‘<!----></a></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/justdoitMr/blogs/" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">ä¸€ã€å¯¼è¯»</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">äºŒã€javaæ ¸å¿ƒ</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">ä¸‰ã€Springç¯‡</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">å››ã€å¤§æ•°æ®ç¯‡</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">äº”ã€äº‘åŸç”Ÿ</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">1ã€Docker</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">2ã€K8S</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/ContainerCloud/k8s/act_one_k8s%E4%B8%AD%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%8E%9F%E7%90%86.md.html" aria-label="1ã€K8sä¸­è´Ÿè½½å‡è¡¡åŸç†"><!--[--><span class="font-icon icon iconfont icon-file" style=""></span><!--]-->1ã€K8sä¸­è´Ÿè½½å‡è¡¡åŸç†<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link vp-sidebar-page active" href="/ContainerCloud/k8s/act_none_pod%E5%BC%82%E5%B8%B8%E7%8A%B6%E6%80%81%E6%8E%92%E6%9F%A5.html" aria-label="2ã€Podå¼‚å¸¸çŠ¶æ€æ’é”™"><!--[--><span class="font-icon icon iconfont icon-file" style=""></span><!--]-->2ã€Podå¼‚å¸¸çŠ¶æ€æ’é”™<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/ContainerCloud/k8s/act_two_k8s%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0.html" aria-label="3ã€K8SåŸºç¡€å­¦ä¹ "><!--[--><span class="font-icon icon iconfont icon-file" style=""></span><!--]-->3ã€K8SåŸºç¡€å­¦ä¹ <!----></a></li></ul></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">äº”ã€å‰ç«¯ç¯‡</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon iconfont icon-file" style=""></span>2ã€Podå¼‚å¸¸çŠ¶æ€æ’é”™</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">bugcode</span></span><span property="author" content="bugcode"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2020-01-01T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 19 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT19M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color0 clickable" role="navigation">K8S</span><span class="page-category-item color2 clickable" role="navigation">DOCKER</span><span class="page-category-item color5 clickable" role="navigation">JAVA</span><!--]--><meta property="articleSection" content="K8S,DOCKER,JAVA"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color2 clickable" role="navigation">DOCKER</span><span class="page-tag-item color5 clickable" role="navigation">äº‘åŸç”Ÿ</span><span class="page-tag-item color0 clickable" role="navigation">K8S</span><!--]--><meta property="keywords" content="DOCKER,äº‘åŸç”Ÿ,K8S"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ä¸€ã€å¸¸ç”¨å‘½ä»¤">ä¸€ã€å¸¸ç”¨å‘½ä»¤</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#äºŒã€podçŠ¶æ€">äºŒã€PodçŠ¶æ€</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ä¸‰ã€podé‡åˆ°çš„é—®é¢˜">ä¸‰ã€podé‡åˆ°çš„é—®é¢˜</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1ã€podä¸€ç›´å¤„äºpendingçŠ¶æ€">1ã€podä¸€ç›´å¤„äºPendingçŠ¶æ€</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2ã€pod-ä¸€ç›´å¤„äº-containercreating-æˆ–-waiting-çŠ¶-æ€">2ã€Pod ä¸€ç›´å¤„äº ContainerCreating æˆ– Waiting çŠ¶ æ€</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3ã€pod-å¤„äº-crashloopbackoff-çŠ¶æ€">3ã€Pod å¤„äº CrashLoopBackOff çŠ¶æ€</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4ã€pod-ä¸€ç›´å¤„äº-terminating-çŠ¶æ€">4ã€Pod ä¸€ç›´å¤„äº Terminating çŠ¶æ€</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5ã€pod-ä¸€ç›´å¤„äº-unknown-çŠ¶æ€">5ã€Pod ä¸€ç›´å¤„äº Unknown çŠ¶æ€</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6ã€pod-ä¸€ç›´å¤„äº-error-çŠ¶æ€">6ã€Pod ä¸€ç›´å¤„äº Error çŠ¶æ€</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7ã€pod-ä¸€ç›´å¤„äº-imagepullbackoff-çŠ¶æ€">7ã€Pod ä¸€ç›´å¤„äº ImagePullBackOff çŠ¶æ€</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_8ã€pod-å¥åº·æ£€æŸ¥å¤±è´¥">8ã€Pod å¥åº·æ£€æŸ¥å¤±è´¥</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><p>2ã€Podå¼‚å¸¸çŠ¶æ€æ’é”™</p><h2 id="ä¸€ã€å¸¸ç”¨å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€å¸¸ç”¨å‘½ä»¤"><span>ä¸€ã€å¸¸ç”¨å‘½ä»¤</span></a></h2><p>é¦–å…ˆåˆ—å‡ºPodæ’æŸ¥è¿‡ç¨‹ä¸­æˆ‘è¿™è¾¹çš„å¸¸ç”¨å‘½ä»¤ï¼š</p><ul><li>æŸ¥çœ‹PodçŠ¶æ€ï¼škubectl get pod podname -o wide</li><li>æŸ¥çœ‹Podçš„yamlé…ç½®ï¼škubectl get pods podname -o yaml</li><li>æŸ¥çœ‹podäº‹ä»¶ï¼škubectl describe pods podname</li><li>æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼škubectl logs podsname -c container-name</li></ul><h2 id="äºŒã€podçŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#äºŒã€podçŠ¶æ€"><span>äºŒã€PodçŠ¶æ€</span></a></h2><ul><li>Errorï¼šPod å¯åŠ¨è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯</li><li>NodeLost : Pod æ‰€åœ¨èŠ‚ç‚¹å¤±è”</li><li>Unkown : Pod æ‰€åœ¨èŠ‚ç‚¹å¤±è”æˆ–å…¶å®ƒæœªçŸ¥å¼‚å¸¸</li><li>Waiting : Pod ç­‰å¾…å¯åŠ¨</li><li>Pending : Pod ç­‰å¾…è¢«è°ƒåº¦</li><li>ContainerCreating : Pod å®¹å™¨æ­£åœ¨è¢«åˆ›å»º</li><li>Terminating : Pod æ­£åœ¨è¢«é”€æ¯</li><li>CrashLoopBackOff ï¼š å®¹å™¨é€€å‡ºï¼Œkubelet æ­£åœ¨å°†å®ƒé‡å¯</li><li>InvalidImageName ï¼š æ— æ³•è§£æé•œåƒåç§°</li><li>ImageInspectError ï¼š æ— æ³•æ ¡éªŒé•œåƒ</li><li>ErrImageNeverPull ï¼š ç­–ç•¥ç¦æ­¢æ‹‰å–é•œåƒ</li><li>ImagePullBackOff ï¼š æ­£åœ¨é‡è¯•æ‹‰å–</li><li>RegistryUnavailable ï¼š è¿æ¥ä¸åˆ°é•œåƒä¸­å¿ƒ</li><li>ErrImagePull ï¼š é€šç”¨çš„æ‹‰å–é•œåƒå‡ºé”™</li><li>CreateContainerConfigError ï¼š ä¸èƒ½åˆ›å»º kubelet ä½¿ç”¨çš„å®¹å™¨é…ç½®</li><li>CreateContainerError ï¼š åˆ›å»ºå®¹å™¨å¤±è´¥</li><li>RunContainerError ï¼š å¯åŠ¨å®¹å™¨å¤±è´¥</li><li>PreStartHookError : æ‰§è¡Œ preStart hook æŠ¥é”™</li><li>PostStartHookError ï¼š æ‰§è¡Œ postStart hook æŠ¥é”™</li><li>ContainersNotInitialized ï¼š å®¹å™¨æ²¡æœ‰åˆå§‹åŒ–å®Œæ¯•</li><li>ContainersNotReady ï¼š å®¹å™¨æ²¡æœ‰å‡†å¤‡å®Œæ¯•</li><li>ContainerCreating ï¼šå®¹å™¨åˆ›å»ºä¸­</li><li>PodInitializing ï¼špod åˆå§‹åŒ–ä¸­</li><li>DockerDaemonNotReady ï¼šdockerè¿˜æ²¡æœ‰å®Œå…¨å¯åŠ¨</li><li>NetworkPluginNotReady ï¼š ç½‘ç»œæ’ä»¶è¿˜æ²¡æœ‰å®Œå…¨å¯åŠ¨</li></ul><h2 id="ä¸‰ã€podé‡åˆ°çš„é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€podé‡åˆ°çš„é—®é¢˜"><span>ä¸‰ã€podé‡åˆ°çš„é—®é¢˜</span></a></h2><h3 id="_1ã€podä¸€ç›´å¤„äºpendingçŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#_1ã€podä¸€ç›´å¤„äºpendingçŠ¶æ€"><span>1ã€podä¸€ç›´å¤„äºPendingçŠ¶æ€</span></a></h3><p>Pending çŠ¶æ€è¯´æ˜ Pod è¿˜æ²¡æœ‰è¢«è°ƒåº¦åˆ°æŸä¸ªèŠ‚ç‚¹ä¸Šï¼Œéœ€è¦çœ‹ä¸‹ Pod äº‹ä»¶è¿›ä¸€æ­¥åˆ¤æ–­åŸå› ï¼Œæ¯”å¦‚:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>$ kubectl describe pod tikv-0 </span></span>
<span class="line"><span>     . ... </span></span>
<span class="line"><span>       Events: </span></span>
<span class="line"><span>        Type     Reason   Age     From   Message </span></span>
<span class="line"><span>         ----    ------   ----    ----    ------- </span></span>
<span class="line"><span>        Warning FailedScheduling 3m (x106 over 33m) default-scheduler 0/4 nodes are available: 1 node(s) had no available volume zone, 2 Insufficient cpu, 3 Insufficient memory.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢æ˜¯æˆ‘é‡åˆ°çš„ä¸€äº›åŸå› ï¼š</p><ul><li><strong>èŠ‚ç‚¹èµ„æºä¸å¤Ÿ</strong>ï¼šèŠ‚ç‚¹èµ„æºä¸å¤Ÿæœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µ: <ul><li>CPUè´Ÿè½½è¿‡é«˜</li><li>å‰©ä½™å¯è¢«åˆ†é…çš„å†…å­˜ä¸è¶³</li><li>å‰©ä½™å¯ç”¨GPUæ•°é‡ä¸è¶³</li></ul></li></ul><p>å¦‚ä½•åˆ¤æ–­æŸä¸ª Node èµ„æºæ˜¯å¦è¶³å¤Ÿï¼Ÿ é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹nodeèµ„æºæƒ…å†µï¼Œå…³æ³¨ä»¥ä¸‹ä¿¡æ¯ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">kubectl describe node nodename</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>Allocatable : è¡¨ç¤ºæ­¤èŠ‚ç‚¹èƒ½å¤Ÿç”³è¯·çš„èµ„æºæ€»å’Œ</li><li>Allocated resources : è¡¨ç¤ºæ­¤èŠ‚ç‚¹å·²åˆ†é…çš„èµ„æº (Allocatable å‡å»èŠ‚ç‚¹ä¸Šæ‰€æœ‰ Pod æ€» çš„ Request)</li></ul><p>å‰è€…ä¸åè€…ç›¸å‡ï¼Œå¯å¾—å‡ºå‰©ä½™å¯ç”³è¯·çš„èµ„æºã€‚å¦‚æœè¿™ä¸ªå€¼å°äº Pod çš„ requestï¼Œå°±ä¸æ»¡è¶³ Pod çš„ èµ„æºè¦æ±‚ï¼ŒScheduler åœ¨ Predicates (é¢„é€‰) é˜¶æ®µå°±ä¼šå‰”é™¤æ‰è¿™ä¸ª Nodeï¼Œä¹Ÿå°±ä¸ä¼šè°ƒåº¦ä¸Šå»ã€‚</p><ul><li><strong>ä¸æ»¡è¶³ nodeSelector ä¸ affinity</strong></li></ul><p>å¦‚æœ Pod åŒ…å« nodeSelector æŒ‡å®šäº†èŠ‚ç‚¹éœ€è¦åŒ…å«çš„ labelï¼Œè°ƒåº¦å™¨å°†åªä¼šè€ƒè™‘å°† Pod è°ƒåº¦åˆ° åŒ…å«è¿™äº› label çš„Node ä¸Šï¼Œå¦‚æœæ²¡æœ‰ Node æœ‰è¿™äº› label æˆ–è€…æœ‰è¿™äº› label çš„ Node å…¶å®ƒ æ¡ä»¶ä¸æ»¡è¶³ä¹Ÿå°†ä¼šæ— æ³•è°ƒåº¦ã€‚å‚è€ƒå®˜æ–¹æ–‡æ¡£<br><a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector</a><br> å¦‚æœ Pod åŒ…å« affinityï¼ˆäº²å’Œæ€§ï¼‰çš„é…ç½®ï¼Œè°ƒåº¦å™¨æ ¹æ®è°ƒåº¦ç®—æ³•ä¹Ÿå¯èƒ½ç®—å‡ºæ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„ Nodeï¼Œä»è€Œæ— æ³•è°ƒåº¦ã€‚affinity æœ‰ä»¥ä¸‹å‡ ç±»:</p><ul><li>nodeAffinity: èŠ‚ç‚¹äº²å’Œæ€§ï¼Œå¯ä»¥çœ‹æˆæ˜¯å¢å¼ºç‰ˆçš„ nodeSelectorï¼Œç”¨äºé™åˆ¶ Pod åªå…è®¸ è¢«è°ƒåº¦åˆ°æŸä¸€éƒ¨åˆ† Nodeã€‚</li><li>podAffinity: Pod äº²å’Œæ€§ï¼Œç”¨äºå°†ä¸€äº›æœ‰å…³è”çš„ Pod è°ƒåº¦åˆ°åŒä¸€ä¸ªåœ°æ–¹ï¼ŒåŒä¸€ä¸ªåœ°æ–¹å¯ä»¥ æ˜¯æŒ‡åŒä¸€ä¸ªèŠ‚ç‚¹æˆ–åŒä¸€ä¸ªå¯ç”¨åŒºçš„èŠ‚ç‚¹ç­‰ã€‚</li><li>podAntiAffinity: Pod åäº²å’Œæ€§ï¼Œç”¨äºé¿å…å°†æŸä¸€ç±» Pod è°ƒåº¦åˆ°åŒä¸€ä¸ªåœ°æ–¹é¿å…å•ç‚¹æ•… éšœï¼Œæ¯”å¦‚å°†é›†ç¾¤ DNS æœåŠ¡çš„ Pod å‰¯æœ¬éƒ½è°ƒåº¦åˆ°ä¸åŒèŠ‚ç‚¹ï¼Œé¿å…ä¸€ä¸ªèŠ‚ç‚¹æŒ‚äº†é€ æˆæ•´ä¸ªé›†ç¾¤ DNS è§£æå¤±è´¥ï¼Œä½¿å¾—ä¸šåŠ¡ä¸­æ–­ã€‚</li></ul><p><strong>Node å­˜åœ¨ Pod æ²¡æœ‰å®¹å¿çš„æ±¡ç‚¹</strong><br> å¦‚æœèŠ‚ç‚¹ä¸Šå­˜åœ¨æ±¡ç‚¹ (Taints)ï¼Œè€Œ Pod æ²¡æœ‰å“åº”çš„å®¹å¿ (Tolerations)ï¼ŒPod ä¹Ÿå°†ä¸ä¼šè°ƒåº¦ä¸Š å»ã€‚é€šè¿‡ describe node å¯ä»¥çœ‹ä¸‹ Node æœ‰å“ªäº› Taints:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>$ kubectl describe nodes host1 </span></span>
<span class="line"><span>    ... </span></span>
<span class="line"><span>    Taints: special=true:NoSchedule</span></span>
<span class="line"><span>    ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ±¡ç‚¹æ—¢å¯ä»¥æ˜¯æ‰‹åŠ¨æ·»åŠ ä¹Ÿå¯ä»¥æ˜¯è¢«è‡ªåŠ¨æ·»åŠ ï¼Œä¸‹é¢å¯ä»¥çœ‹ä¸€ä¸‹ã€‚<br><strong>æ‰‹åŠ¨æ·»åŠ çš„æ±¡ç‚¹ï¼š</strong><br> é€šè¿‡ç±»ä¼¼ä»¥ä¸‹æ–¹å¼å¯ä»¥ç»™èŠ‚ç‚¹æ·»åŠ æ±¡ç‚¹:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>$ kubectl taint node host1 special=true:NoSchedule </span></span>
<span class="line"><span>  node &quot;host1&quot; tainted</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦å¤–ï¼Œæœ‰äº›åœºæ™¯ä¸‹å¸Œæœ›æ–°åŠ çš„èŠ‚ç‚¹é»˜è®¤ä¸è°ƒåº¦ Podï¼Œç›´åˆ°è°ƒæ•´å®ŒèŠ‚ç‚¹ä¸ŠæŸäº›é…ç½®æ‰å…è®¸è°ƒåº¦ï¼Œå°±ç»™æ–°åŠ  <a href="http://xn--node-z94fz6v820d7xjpj0agd6a.kubernetes.io/unschedulable" target="_blank" rel="noopener noreferrer">çš„èŠ‚ç‚¹éƒ½åŠ ä¸Šnode.kubernetes.io/unschedulable</a> è¿™ä¸ªæ±¡ç‚¹ã€‚<br><strong>è‡ªåŠ¨æ·»åŠ çš„æ±¡ç‚¹</strong><br> å¦‚æœèŠ‚ç‚¹è¿è¡ŒçŠ¶æ€ä¸æ­£å¸¸ï¼Œæ±¡ç‚¹ä¹Ÿå¯ä»¥è¢«è‡ªåŠ¨æ·»åŠ ï¼Œä» v1.12 å¼€å§‹ï¼Œ TaintNodesByCondition ç‰¹æ€§è¿›å…¥ Beta é»˜è®¤å¼€å¯ï¼Œcontroller manager ä¼šæ£€æŸ¥ Node çš„ Conditionï¼Œå¦‚æœå‘½ä¸­æ¡ä»¶ å°±è‡ªåŠ¨ä¸º Node åŠ ä¸Šç›¸åº”çš„æ±¡ç‚¹ï¼Œè¿™äº› Condition ä¸ Taints çš„å¯¹åº”å…³ç³»å¦‚ä¸‹:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>Conditon Value Taints </span></span>
<span class="line"><span> -------- ----- ------</span></span>
<span class="line"><span> OutOfDisk True node.kubernetes.io/out-of-disk</span></span>
<span class="line"><span> Ready False node.kubernetes.io/not-ready</span></span>
<span class="line"><span> Ready Unknown node.kubernetes.io/unreachable</span></span>
<span class="line"><span> MemoryPressure True node.kubernetes.io/memory-pressure</span></span>
<span class="line"><span> PIDPressure True node.kubernetes.io/pid-pressure</span></span>
<span class="line"><span> DiskPressure True node.kubernetes.io/disk-pressure</span></span>
<span class="line"><span> NetworkUnavailable True node.kubernetes.io/network-unavailable</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è§£é‡Šä¸‹ä¸Šé¢å„ç§æ¡ä»¶çš„æ„æ€:</p><ul><li>OutOfDisk ä¸º True è¡¨ç¤ºèŠ‚ç‚¹ç£ç›˜ç©ºé—´ä¸å¤Ÿäº†</li><li>Ready ä¸º False è¡¨ç¤ºèŠ‚ç‚¹ä¸å¥åº·</li><li>Ready ä¸º Unknown è¡¨ç¤ºèŠ‚ç‚¹å¤±è”ï¼Œåœ¨ node-monitor-grace-period è¿™ä¹ˆé•¿çš„æ—¶é—´å†…æ²¡æœ‰ ä¸ŠæŠ¥çŠ¶æ€ controller-manager å°±ä¼šå°† Node çŠ¶æ€ç½®ä¸º Unknown (é»˜è®¤ 40s)</li><li>MemoryPressure ä¸º True è¡¨ç¤ºèŠ‚ç‚¹å†…å­˜å‹åŠ›å¤§ï¼Œå®é™…å¯ç”¨å†…å­˜å¾ˆå°‘</li><li>PIDPressure ä¸º True è¡¨ç¤ºèŠ‚ç‚¹ä¸Šè¿è¡Œäº†å¤ªå¤šè¿›ç¨‹ï¼ŒPID æ•°é‡ä¸å¤Ÿç”¨äº†</li><li>DiskPressure ä¸º True è¡¨ç¤ºèŠ‚ç‚¹ä¸Šçš„ç£ç›˜å¯ç”¨ç©ºé—´å¤ªå°‘äº†</li><li>NetworkUnavailable ä¸º True è¡¨ç¤ºèŠ‚ç‚¹ä¸Šçš„ç½‘ç»œæ²¡æœ‰æ­£ç¡®é…ç½®ï¼Œæ— æ³•è·Ÿå…¶å®ƒ Pod æ­£å¸¸é€š ä¿¡</li></ul><p>å¦å¤–ï¼Œåœ¨äº‘ç¯å¢ƒä¸‹ï¼Œæ¯”å¦‚è…¾è®¯äº‘ TKEï¼Œæ·»åŠ æ–°èŠ‚ç‚¹ä¼šå…ˆç»™è¿™ä¸ª Node åŠ ä¸Š<br><a href="http://node.cloudprovider.kubernetes.io/uninitialized" target="_blank" rel="noopener noreferrer">node.cloudprovider.kubernetes.io/uninitialized</a> çš„æ±¡ç‚¹ï¼Œç­‰ Node åˆå§‹åŒ–æˆåŠŸåæ‰è‡ªåŠ¨ç§» é™¤è¿™ä¸ªæ±¡ç‚¹ï¼Œé¿å… Pod è¢«è°ƒåº¦åˆ°æ²¡åˆå§‹åŒ–å¥½çš„ Node ä¸Šã€‚<br><strong>ä½ç‰ˆæœ¬ kube-scheduler çš„ bug</strong><br> å¯èƒ½æ˜¯ä½ç‰ˆæœ¬ kube-scheduler çš„ bug, å¯ä»¥å‡çº§ä¸‹è°ƒåº¦å™¨ç‰ˆæœ¬ã€‚<br><strong>kube-scheduler æ²¡æœ‰æ­£å¸¸è¿è¡Œ</strong><br> æ£€æŸ¥ maser ä¸Šçš„ kube-scheduler æ˜¯å¦è¿è¡Œæ­£å¸¸ï¼Œå¼‚å¸¸çš„è¯å¯ä»¥å°è¯•é‡å¯ä¸´æ—¶æ¢å¤ã€‚<br><strong>é©±é€åå…¶å®ƒå¯ç”¨èŠ‚ç‚¹ä¸å½“å‰èŠ‚ç‚¹æœ‰çŠ¶æ€åº”ç”¨ä¸åœ¨åŒä¸€ä¸ªå¯ç”¨åŒº</strong></p><p>æœ‰æ—¶å€™æœåŠ¡éƒ¨ç½²æˆåŠŸè¿è¡Œè¿‡ï¼Œä½†åœ¨æŸä¸ªæ—¶å€™èŠ‚ç‚¹çªç„¶æŒ‚äº†ï¼Œæ­¤æ—¶å°±ä¼šè§¦å‘é©±é€ï¼Œåˆ›å»ºæ–°çš„å‰¯æœ¬è°ƒåº¦åˆ°å…¶ å®ƒèŠ‚ç‚¹ä¸Šï¼Œå¯¹äºå·²ç»æŒ‚è½½äº†ç£ç›˜çš„ Podï¼Œå®ƒé€šå¸¸éœ€è¦è¢«è°ƒåº¦åˆ°è·Ÿå½“å‰èŠ‚ç‚¹å’Œç£ç›˜åœ¨åŒä¸€ä¸ªå¯ç”¨åŒºï¼Œå¦‚æœ é›†ç¾¤ä¸­åŒä¸€ä¸ªå¯ç”¨åŒºçš„èŠ‚ç‚¹ä¸æ»¡è¶³è°ƒåº¦æ¡ä»¶ï¼Œå³ä½¿å…¶å®ƒå¯ç”¨åŒºèŠ‚ç‚¹å„ç§æ¡ä»¶éƒ½æ»¡è¶³ï¼Œä½†ä¸è·Ÿå½“å‰èŠ‚ç‚¹åœ¨ åŒä¸€ä¸ªå¯ç”¨åŒºï¼Œä¹Ÿæ˜¯ä¸ä¼šè°ƒåº¦çš„ã€‚ä¸ºä»€ä¹ˆéœ€è¦é™åˆ¶æŒ‚è½½äº†ç£ç›˜çš„ Pod ä¸èƒ½æ¼‚ç§»åˆ°å…¶å®ƒå¯ç”¨åŒºçš„èŠ‚ç‚¹ï¼Ÿ è¯•æƒ³ä¸€ä¸‹ï¼Œäº‘ä¸Šçš„ç£ç›˜è™½ç„¶å¯ä»¥è¢«åŠ¨æ€æŒ‚è½½åˆ°ä¸åŒæœºå™¨ï¼Œä½†ä¹Ÿåªæ˜¯ç›¸å¯¹åŒä¸€ä¸ª<a href="https://so.csdn.net/so/search?q=%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">æ•°æ®ä¸­å¿ƒ</a>ï¼Œé€šå¸¸ä¸å…è®¸è·¨æ•°æ®ä¸­å¿ƒæŒ‚è½½ç£ç›˜è®¾å¤‡ï¼Œå› ä¸ºç½‘ç»œæ—¶å»¶ä¼šæå¤§çš„é™ä½ IO é€Ÿç‡ã€‚</p><h3 id="_2ã€pod-ä¸€ç›´å¤„äº-containercreating-æˆ–-waiting-çŠ¶-æ€" tabindex="-1"><a class="header-anchor" href="#_2ã€pod-ä¸€ç›´å¤„äº-containercreating-æˆ–-waiting-çŠ¶-æ€"><span>2ã€Pod ä¸€ç›´å¤„äº ContainerCreating æˆ– Waiting çŠ¶ æ€</span></a></h3><ul><li><strong>Pod é…ç½®é”™è¯¯</strong><ul><li>æ£€æŸ¥æ˜¯å¦æ‰“åŒ…äº†æ­£ç¡®çš„é•œåƒ</li><li>æ£€æŸ¥é…ç½®äº†æ­£ç¡®çš„å®¹å™¨å‚æ•°</li></ul></li><li><strong>æŒ‚è½½ Volume å¤±è´¥</strong><ul><li>Volume æŒ‚è½½å¤±è´¥ä¹Ÿåˆ†è®¸å¤šç§æƒ…å†µï¼Œå…ˆåˆ—ä¸‹æˆ‘è¿™é‡Œç›®å‰å·²çŸ¥çš„ã€‚</li></ul></li></ul><p><strong>Pod æ¼‚ç§»æ²¡æœ‰æ­£å¸¸è§£æŒ‚ä¹‹å‰çš„ç£ç›˜</strong></p><blockquote><p>åœ¨äº‘å°è¯•æ‰˜ç®¡çš„ <a href="https://so.csdn.net/so/search?q=K8S&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">K8S</a> æœåŠ¡ç¯å¢ƒä¸‹ï¼Œé»˜è®¤æŒ‚è½½çš„ Volume ä¸€èˆ¬æ˜¯å—å­˜å‚¨ç±»å‹çš„äº‘ç¡¬ç›˜ï¼Œå¦‚æœæŸä¸ªèŠ‚ç‚¹ æŒ‚äº†ï¼Œkubelet æ— æ³•æ­£å¸¸è¿è¡Œæˆ–ä¸ apiserver é€šä¿¡ï¼Œåˆ°è¾¾æ—¶é—´é˜€å€¼åä¼šè§¦å‘é©±é€ï¼Œè‡ªåŠ¨åœ¨å…¶å®ƒèŠ‚ç‚¹ ä¸Šå¯åŠ¨ç›¸åŒçš„å‰¯æœ¬ (Pod æ¼‚ç§»)ï¼Œä½†æ˜¯ç”±äºè¢«é©±é€çš„ Node æ— æ³•æ­£å¸¸è¿è¡Œå¹¶ä¸çŸ¥é“è‡ªå·±è¢«é©±é€äº†ï¼Œä¹Ÿ å°±æ²¡æœ‰æ­£å¸¸æ‰§è¡Œè§£æŒ‚ï¼Œcloud-controller-manager ä¹Ÿåœ¨ç­‰è§£æŒ‚æˆåŠŸåå†è°ƒç”¨äº‘å‚å•†çš„æ¥å£å°†ç£ç›˜ çœŸæ­£ä»èŠ‚ç‚¹ä¸Šè§£æŒ‚ï¼Œé€šå¸¸ä¼šç­‰åˆ°ä¸€ä¸ªæ—¶é—´é˜€å€¼å cloud-controller-manager ä¼šå¼ºåˆ¶è§£æŒ‚äº‘ç›˜ï¼Œ ç„¶åå†å°†å…¶æŒ‚è½½åˆ° Pod æœ€æ–°æ‰€åœ¨èŠ‚ç‚¹ä¸Šï¼Œè¿™ç§æƒ…å†µä¸‹ ContainerCreating çš„æ—¶é—´ç›¸å¯¹é•¿ä¸€ç‚¹ï¼Œä½† ä¸€èˆ¬æœ€ç»ˆæ˜¯å¯ä»¥å¯åŠ¨æˆåŠŸçš„ï¼Œé™¤éäº‘å‚å•†çš„ cloud-controller-manager é€»è¾‘æœ‰ bugã€‚</p></blockquote><p><strong>ç£ç›˜çˆ†æ»¡</strong><br> å¯åŠ¨ Pod ä¼šè°ƒ CRI æ¥å£åˆ›å»ºå®¹å™¨ï¼Œå®¹å™¨è¿è¡Œæ—¶åˆ›å»ºå®¹å™¨æ—¶é€šå¸¸ä¼šåœ¨æ•°æ®ç›®å½•ä¸‹ä¸ºæ–°å»ºçš„å®¹å™¨åˆ›å»ºä¸€ äº›ç›®å½•å’Œæ–‡ä»¶ï¼Œå¦‚æœæ•°æ®ç›®å½•æ‰€åœ¨çš„ç£ç›˜ç©ºé—´æ»¡äº†å°±ä¼šåˆ›å»ºå¤±è´¥å¹¶æŠ¥é”™:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>Eventsï¼š</span></span>
<span class="line"><span>    Type Reason Age From</span></span>
<span class="line"><span>Message</span></span>
<span class="line"><span>     ---- ------ ---- ----</span></span>
<span class="line"><span> Warning FailedCreatePodSandBox 2m (x4307 over 16h) kubelet, 10.179.80.31 (combined from similar events): Failed create pod sandbox: rpc error: code = Unknown desc = failed to create a sandbox for pod &quot;apigateway-6dc48bf8b6-l8xrw&quot;: Error response from daemon: mkdir /var/lib/docker/aufs/mnt/1f09d6c1c9f24e8daaea5bf33a4230de7dbc758e3b22785e8ee21e3e3d921214 no space left on device</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¤„ç†æ–¹æ³•: <a href="https://blog.csdn.net/qq_31055683/article/details/126974456" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qq_31055683/article/details/126974456</a><br><strong>èŠ‚ç‚¹å†…å­˜ç¢ç‰‡åŒ–</strong><br> å¦‚æœèŠ‚ç‚¹ä¸Šå†…å­˜ç¢ç‰‡åŒ–ä¸¥é‡ï¼Œç¼ºå°‘å¤§é¡µå†…å­˜ï¼Œä¼šå¯¼è‡´å³ä½¿æ€»çš„å‰©ä½™å†…å­˜è¾ƒå¤šï¼Œä½†è¿˜æ˜¯ä¼šç”³è¯·å†…å­˜å¤±è´¥ï¼Œå¤„ç†æ–¹æ³•è¯·çœ‹ï¼š<a href="https://blog.csdn.net/qq_31055683/article/details/126974873" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qq_31055683/article/details/12697487</a><br><strong>limit è®¾ç½®å¤ªå°æˆ–è€…å•ä½ä¸å¯¹</strong><br> å¦‚æœ limit è®¾ç½®è¿‡å°ä»¥è‡³äºä¸è¶³ä»¥æˆåŠŸè¿è¡Œ Sandbox ä¹Ÿä¼šé€ æˆè¿™ç§çŠ¶æ€ï¼Œå¸¸è§çš„æ˜¯å› ä¸º memory limit å•ä½è®¾ç½®ä¸å¯¹é€ æˆçš„ limit è¿‡å°ï¼Œæ¯”å¦‚è¯¯å°† memory çš„ limit å•ä½åƒ request ä¸€æ ·è®¾ ç½®ä¸ºå° <strong>m</strong> ï¼Œè¿™ä¸ªå•ä½åœ¨ memory ä¸é€‚ç”¨ï¼Œä¼šè¢« k8s è¯†åˆ«æˆ byteï¼Œ åº”è¯¥ç”¨ <strong>Mi</strong> æˆ–<strong>M</strong><br><em>ä¸¾ä¸ªä¾‹å­: å¦‚æœ memory limit è®¾ä¸º 1024m è¡¨ç¤ºé™åˆ¶ 1.024 Byteï¼Œè¿™ä¹ˆå°çš„å†…å­˜ï¼Œ pause å®¹å™¨ä¸€èµ·æ¥å°±ä¼šè¢« cgroup-oom kill æ‰ï¼Œå¯¼è‡´ pod çŠ¶æ€ä¸€ç›´å¤„äº ContainerCreatingã€‚</em><br> è¿™ç§æƒ…å†µé€šå¸¸ä¼šæŠ¥ä¸‹é¢çš„ event:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>Pod sandbox changed, it will be killed and re-createdã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>kubelet æŠ¥é”™:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>to start sandbox container for pod ... Error response from daemon: OCI runtime create failed: container_linux.go:348: starting container process caused &quot;process_linux.go:301: running exec setns process for init caused \&quot;signal: killed\&quot;&quot;: unknown</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>æ‹‰å–é•œåƒå¤±è´¥</strong><br> é•œåƒæ‹‰å–å¤±è´¥ä¹Ÿåˆ†å¾ˆå¤šæƒ…å†µï¼Œè¿™é‡Œåˆ—ä¸¾ä¸‹:</p><ul><li>é…ç½®äº†é”™è¯¯çš„é•œåƒ</li><li>Kubelet æ— æ³•è®¿é—®é•œåƒä»“åº“ï¼ˆæ¯”å¦‚é»˜è®¤ pause é•œåƒåœ¨ <a href="http://gcr.io" target="_blank" rel="noopener noreferrer">gcr.io</a> ä¸Šï¼Œå›½å†…ç¯å¢ƒè®¿é—®éœ€è¦ç‰¹æ®Šå¤„ ç†ï¼‰</li><li>æ‹‰å–ç§æœ‰é•œåƒçš„ imagePullSecret æ²¡æœ‰é…ç½®æˆ–é…ç½®æœ‰è¯¯</li><li>é•œåƒå¤ªå¤§ï¼Œæ‹‰å–è¶…æ—¶ï¼ˆå¯ä»¥é€‚å½“è°ƒæ•´ kubelet çš„ â€”image-pull-progress-deadline å’Œ â€”runtime-request-timeout é€‰é¡¹ï¼‰</li></ul><p><strong>CNI ç½‘ç»œé”™è¯¯</strong><br> å¦‚æœå‘ç”Ÿ CNI ç½‘ç»œé”™è¯¯é€šå¸¸éœ€è¦æ£€æŸ¥ä¸‹ç½‘ç»œæ’ä»¶çš„é…ç½®å’Œè¿è¡ŒçŠ¶æ€ï¼Œå¦‚æœæ²¡æœ‰æ­£ç¡®é…ç½®æˆ–æ­£å¸¸è¿è¡Œé€š å¸¸è¡¨ç°ä¸º:</p><ul><li>æ— æ³•é…ç½® Pod ç½‘ç»œ</li><li>æ— æ³•åˆ†é… Pod IP</li></ul><p><strong>controller-manager å¼‚å¸¸</strong><br> æŸ¥çœ‹ master ä¸Š kube-controller-manager çŠ¶æ€ï¼Œå¼‚å¸¸çš„è¯å°è¯•é‡å¯ã€‚<br><strong>å®‰è£… docker æ²¡åˆ å¹²å‡€æ—§ç‰ˆæœ¬</strong></p><p>å¦‚æœèŠ‚ç‚¹ä¸Šæœ¬èº«æœ‰ docker æˆ–è€…æ²¡åˆ å¹²å‡€ï¼Œç„¶ååˆå®‰è£… dockerï¼Œæ¯”å¦‚åœ¨ centos ä¸Šç”¨ yum å®‰è£…:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>yum install -y docker</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™æ ·å¯èƒ½ä¼šå¯¼è‡´ dockerd åˆ›å»ºå®¹å™¨ä¸€ç›´ä¸æˆåŠŸï¼Œä»è€Œ Pod çŠ¶æ€ä¸€ç›´ ContainerCreatingï¼ŒæŸ¥çœ‹ event æŠ¥é”™:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>Type     Reason        Age       From</span></span>
<span class="line"><span>Message</span></span>
<span class="line"><span>      ----    ------       ----       ----</span></span>
<span class="line"><span>      Warning FailedCreatePodSandBox 18m (x3583 over 83m) kubelet, 192.168.4.5 (combined from similar events): Failed create pod sandbox: rpc error: code = Unknown desc = failed to start sandbox container for pod &quot;nginx-7db9fccd9b-2j6dh&quot;: Error response from daemon: ttrpc: client shutting down: read unix @-&gt;@/containerd- shim/moby/de2bfeefc999af42783115acca62745e6798981dff75f4148fae8c086668f667/shim.sock</span></span>
<span class="line"><span> read: connection reset by peer: unknown</span></span>
<span class="line"><span> Normal SandboxChanged 3m12s (x4420 over 83m) kubelet, 192.168.4.5</span></span>
<span class="line"><span> Pod sandbox changed, it will be killed and re-created</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯èƒ½æ˜¯å› ä¸ºé‡å¤å®‰è£… docker ç‰ˆæœ¬ä¸ä¸€è‡´å¯¼è‡´ä¸€äº›ç»„ä»¶ä¹‹é—´ä¸å…¼å®¹ï¼Œä»è€Œå¯¼è‡´ dockerd æ— æ³•æ­£å¸¸åˆ› å»ºå®¹å™¨ã€‚</p><ul><li><strong>å­˜åœ¨åŒåå®¹å™¨</strong></li></ul><p>å¦‚æœèŠ‚ç‚¹ä¸Šå·²æœ‰åŒåå®¹å™¨ï¼Œåˆ›å»º sandbox å°±ä¼šå¤±è´¥ï¼Œevent:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>Warning FailedCreatePodSandBox 2m kubelet, 10.205.8.91 Failed create pod sandbox: rpc error: code = Unknown desc = failed to create a sandbox for pod &quot;lomp-ext-d8c8b8c46-4v8tl&quot;: operation timeout: context deadline exceeded</span></span>
<span class="line"><span>Warning FailedCreatePodSandBox 3s (x12 over 2m) kubelet, 10.205.8.91 Failed create pod sandbox: rpc error: code = Unknown desc = failed to create a sandbox for pod &quot;lomp-ext-d8c8b8c46-4v8tl&quot;: Error response from daemon: Conflict. The container name &quot;/k8s_POD_lomp-ext-d8c8b8c46- 4v8tl_default_65046a06-f795-11e9-9bb6-b67fb7a70bad_0&quot; is already in use by container &quot;30aa3f5847e0ce89e9d411e76783ba14accba7eb7743e605a10a9a862a72c1e2&quot;. You have to remove (or rename) that container to be able to reuse that name.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>å…³äºä»€ä¹ˆæƒ…å†µä¸‹ä¼šäº§ç”ŸåŒåå®¹å™¨ï¼Œè¿™ä¸ªæœ‰å¾…ç ”ç©¶ã€‚</p><h3 id="_3ã€pod-å¤„äº-crashloopbackoff-çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#_3ã€pod-å¤„äº-crashloopbackoff-çŠ¶æ€"><span>3ã€Pod å¤„äº CrashLoopBackOff çŠ¶æ€</span></a></h3><p>Pod å¦‚æœå¤„äº CrashLoopBackOff çŠ¶æ€è¯´æ˜ä¹‹å‰æ˜¯å¯åŠ¨äº†ï¼Œåªæ˜¯åˆå¼‚å¸¸é€€å‡ºäº†ï¼Œåªè¦ Pod çš„ restartPolicyä¸æ˜¯ Never å°±å¯èƒ½è¢«é‡å¯æ‹‰èµ·ï¼Œæ­¤æ—¶ Pod çš„ RestartCounts é€šå¸¸æ˜¯å¤§äº 0 çš„ï¼Œå¯ä»¥å…ˆçœ‹ä¸‹å®¹å™¨è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ç æ¥ç¼©å°é—®é¢˜èŒƒå›´</p><ul><li><strong>å®¹å™¨è¿›ç¨‹ä¸»åŠ¨é€€å‡ºï¼š</strong></li></ul><hr><p>å¦‚æœæ˜¯å®¹å™¨è¿›ç¨‹ä¸»åŠ¨é€€å‡ºï¼Œé€€å‡ºçŠ¶æ€ç ä¸€èˆ¬åœ¨ 0-128 ä¹‹é—´ï¼Œé™¤äº†å¯èƒ½æ˜¯ä¸šåŠ¡ç¨‹åº BUGï¼Œè¿˜æœ‰å…¶å®ƒè®¸ å¤šå¯èƒ½åŸå› </p><ul><li><strong>ç³»ç»ŸOOM</strong></li></ul><hr><p>å¦‚æœå‘ç”Ÿç³»ç»Ÿ OOMï¼Œå¯ä»¥çœ‹åˆ° Pod ä¸­å®¹å™¨é€€å‡ºçŠ¶æ€ç æ˜¯ 137ï¼Œè¡¨ç¤ºè¢« SIGKILL ä¿¡å·æ€æ­»ï¼ŒåŒæ—¶ å†…æ ¸ä¼šæŠ¥é”™: Out of memory: Kill process â€¦ ã€‚å¤§æ¦‚ç‡æ˜¯èŠ‚ç‚¹ä¸Šéƒ¨ç½²äº†å…¶å®ƒé K8S ç®¡ç†çš„è¿› ç¨‹æ¶ˆè€—äº†æ¯”è¾ƒå¤šçš„å†…å­˜ï¼Œæˆ–è€… kubelet çš„ --kube-reserved å’Œ --system-reserved é…çš„ æ¯”è¾ƒå°ï¼Œæ²¡æœ‰é¢„ç•™è¶³å¤Ÿçš„ç©ºé—´ç»™å…¶å®ƒéå®¹å™¨è¿›ç¨‹ï¼ŒèŠ‚ç‚¹ä¸Šæ‰€æœ‰ Pod çš„å®é™…å†…å­˜å ç”¨æ€»é‡ä¸ä¼šè¶…è¿‡ /sys/fs/cgroup/memory/kubepods è¿™é‡Œ cgroup çš„é™åˆ¶ï¼Œè¿™ä¸ªé™åˆ¶ç­‰äº capacity - &quot;kube- reserved&quot; - &quot;system-reserved&quot; ï¼Œå¦‚æœé¢„ç•™ç©ºé—´è®¾ç½®åˆç†ï¼ŒèŠ‚ç‚¹ä¸Šå…¶å®ƒéå®¹å™¨è¿›ç¨‹ï¼ˆkubelet, dockerd, kube-proxy, sshd ç­‰) å†…å­˜å ç”¨æ²¡æœ‰è¶…è¿‡ kubelet é…ç½®çš„é¢„ç•™ç©ºé—´æ˜¯ä¸ä¼šå‘ç”Ÿç³»ç»Ÿ OOM çš„ï¼Œå¯ä»¥æ ¹æ®å®é™…éœ€æ±‚åšåˆç†çš„è°ƒæ•´ã€‚</p><ul><li><strong>ç³»ç»ŸOOM</strong></li></ul><hr><p>å¦‚æœæ˜¯ cgrou OOM æ€æ‰çš„è¿›ç¨‹ï¼Œä» Pod äº‹ä»¶çš„ä¸‹ Reason å¯ä»¥çœ‹åˆ°æ˜¯ OOMKilled ï¼Œè¯´æ˜ å®¹å™¨å®é™…å ç”¨çš„å†…å­˜è¶…è¿‡ limit äº†ï¼ŒåŒæ—¶å†…æ ¸æ—¥å¿—ä¼šæŠ¥: ``ã€‚ å¯ä»¥æ ¹æ®éœ€æ±‚è°ƒæ•´ä¸‹ limitã€‚</p><ul><li><strong>èŠ‚ç‚¹å†…å­˜ç¢ç‰‡åŒ–</strong></li></ul><hr><p>å¦‚æœèŠ‚ç‚¹ä¸Šå†…å­˜ç¢ç‰‡åŒ–ä¸¥é‡ï¼Œç¼ºå°‘å¤§é¡µå†…å­˜ï¼Œä¼šå¯¼è‡´å³ä½¿æ€»çš„å‰©ä½™å†…å­˜è¾ƒå¤šï¼Œä½†è¿˜æ˜¯ä¼šç”³è¯·å†…å­˜å¤±è´¥ï¼Œ</p><ul><li><strong>å¥åº·æ£€æŸ¥å¤±è´¥</strong></li></ul><hr><h3 id="_4ã€pod-ä¸€ç›´å¤„äº-terminating-çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#_4ã€pod-ä¸€ç›´å¤„äº-terminating-çŠ¶æ€"><span>4ã€Pod ä¸€ç›´å¤„äº Terminating çŠ¶æ€</span></a></h3><ul><li><strong>ç£ç›˜çˆ†æ»¡</strong></li></ul><hr><p>å¦‚æœ docker çš„æ•°æ®ç›®å½•æ‰€åœ¨ç£ç›˜è¢«å†™æ»¡ï¼Œdocker æ— æ³•æ­£å¸¸è¿è¡Œï¼Œæ— æ³•è¿›è¡Œåˆ é™¤å’Œåˆ›å»ºæ“ä½œï¼Œæ‰€ä»¥ kubelet è°ƒç”¨ docker åˆ é™¤å®¹å™¨æ²¡ååº”ï¼Œçœ‹ event ç±»ä¼¼è¿™æ ·ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>Normal Killing 39s (x735 over 15h) kubelet, 10.179.80.31 Killing container with id docker://apigateway:Need to kill Pod</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><strong>å­˜åœ¨ â€œiâ€ æ–‡ä»¶å±æ€§</strong></li></ul><hr><p>å¦‚æœå®¹å™¨çš„é•œåƒæœ¬èº«æˆ–è€…å®¹å™¨å¯åŠ¨åå†™å…¥çš„æ–‡ä»¶å­˜åœ¨ â€œiâ€ æ–‡ä»¶å±æ€§ï¼Œæ­¤æ–‡ä»¶å°±æ— æ³•è¢«ä¿®æ”¹åˆ é™¤ï¼Œè€Œåˆ  é™¤ Pod æ—¶ä¼šæ¸…ç†å®¹å™¨ç›®å½•ï¼Œä½†é‡Œé¢åŒ…å«æœ‰ä¸å¯åˆ é™¤çš„æ–‡ä»¶ï¼Œå°±ä¸€ç›´åˆ ä¸äº†ï¼ŒPod çŠ¶æ€ä¹Ÿå°†ä¸€ç›´ä¿æŒ Terminatingï¼Œkubelet æŠ¥é”™:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>Sep 27 14:37:21 VM_0_7_centos kubelet[14109]: E0927 14:37:21.922965 14109 remote_runtime RemoveContainer &quot;19d837c77a3c294052a99ff9347c520bc8acb7b8b9a9dc9fab281fc09df38257&quot; failed: rpc error: code = Unknown desc = failed to remove container &quot;19d837c77a3c294052a99ff9347c520bc8acb7b8b9a9dc9fab281fc09df38257&quot;: Error response 19d837c77a3c294052a99ff9347c520bc8acb7b8b9a9dc9fab281fc09df38257: driver &quot;overlay2&quot; filesystem: remove /data/docker/overlay2/b1aea29c590aa9abda79f7cf3976422073fb3652757f0391db88534027546868 operation not permitted</span></span>
<span class="line"><span>Sep 27 14:37:21 VM_0_7_centos kubelet[14109]: E0927 14:37:21.923027 14109 kuberuntime_gc to remove container &quot;19d837c77a3c294052a99ff9347c520bc8acb7b8b9a9dc9fab281fc09df38257&quot; Unknown desc = failed to remove container &quot;19d837c77a3c294052a99ff9347c520bc8acb7b8b9a9dc9fab281fc09df38257&quot;: Error response 19d837c77a3c294052a99ff9347c520bc8acb7b8b9a9dc9fab281fc09df38257: driver &quot;overlay2&quot; filesystem: remove /data/docker/overlay2/b1aea29c590aa9abda79f7cf3976422073fb3652757f0391db88534027546868 operation not permitted</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ <strong>man chattr</strong> æŸ¥çœ‹ â€œiâ€ æ–‡ä»¶å±æ€§æè¿°:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>A file with the &#39;i&#39; attribute cannot be modified: it cannot be deleted or renamed, no link can be created to this file and no data can be written to the file. Only the superuser or a process possessing the CAP_LINUX_IMMUTABLE capability can set or clear this attribute.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å½»åº•è§£å†³å½“ç„¶æ˜¯ä¸è¦åœ¨å®¹å™¨é•œåƒä¸­æˆ–å¯åŠ¨åçš„å®¹å™¨è®¾ç½® â€œiâ€ æ–‡ä»¶å±æ€§ï¼Œä¸´æ—¶æ¢å¤æ–¹æ³•ï¼š å¤åˆ¶ kubelet æ—¥å¿—æŠ¥é”™æç¤ºçš„æ–‡ä»¶è·¯å¾„ï¼Œç„¶åæ‰§è¡Œ chattr -i æ–‡ä»¶å :</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>chattr -i /data/docker/overlay2/b1aea29c590aa9abda79f7cf3976422073fb3652757f0391db88534027</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ‰§è¡Œå®Œåç­‰å¾… kubelet è‡ªåŠ¨é‡è¯•ï¼ŒPod å°±å¯ä»¥è¢«è‡ªåŠ¨åˆ é™¤äº†ã€‚</p><ul><li><strong>å­˜åœ¨ Finalizers</strong></li></ul><hr><p>k8s èµ„æºçš„ metadata é‡Œå¦‚æœå­˜åœ¨ finalizers ï¼Œé‚£ä¹ˆè¯¥èµ„æºä¸€èˆ¬æ˜¯ç”±æŸç¨‹åºåˆ›å»ºçš„ï¼Œå¹¶ä¸”åœ¨å…¶ åˆ›å»ºçš„èµ„æºçš„ metadata é‡Œçš„ finalizers åŠ äº†ä¸€ä¸ªå®ƒçš„æ ‡è¯†ï¼Œè¿™æ„å‘³ç€è¿™ä¸ªèµ„æºè¢«åˆ é™¤æ—¶éœ€è¦ ç”±åˆ›å»ºèµ„æºçš„ç¨‹åºæ¥åšåˆ é™¤å‰çš„æ¸…ç†ï¼Œæ¸…ç†å®Œäº†å®ƒéœ€è¦å°†æ ‡è¯†ä»è¯¥èµ„æºçš„ finalizers ä¸­ç§»é™¤ï¼Œç„¶ åæ‰ä¼šæœ€ç»ˆå½»åº•åˆ é™¤èµ„æºã€‚æ¯”å¦‚ Rancher åˆ›å»ºçš„ä¸€äº›èµ„æºå°±ä¼šå†™å…¥ finalizers æ ‡è¯†ã€‚<br> å¤„ç†å»ºè®®ï¼š kubectl edit æ‰‹åŠ¨ç¼–è¾‘èµ„æºå®šä¹‰ï¼Œåˆ æ‰ finalizers ï¼Œè¿™æ—¶å†çœ‹ä¸‹èµ„æºï¼Œå°±ä¼šå‘ç° å·²ç»åˆ æ‰äº†</p><h3 id="_5ã€pod-ä¸€ç›´å¤„äº-unknown-çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#_5ã€pod-ä¸€ç›´å¤„äº-unknown-çŠ¶æ€"><span>5ã€Pod ä¸€ç›´å¤„äº Unknown çŠ¶æ€</span></a></h3><p>é€šå¸¸æ˜¯èŠ‚ç‚¹å¤±è”ï¼Œæ²¡æœ‰ä¸ŠæŠ¥çŠ¶æ€ç»™ apiserverï¼Œåˆ°è¾¾é˜€å€¼å controller-manager è®¤ä¸ºèŠ‚ç‚¹å¤±è” å¹¶å°†å…¶çŠ¶æ€ç½®ä¸º Unknown<br> å¯èƒ½åŸå› :</p><ul><li>èŠ‚ç‚¹é«˜è´Ÿè½½å¯¼è‡´æ— æ³•ä¸ŠæŠ¥</li><li>èŠ‚ç‚¹å®•æœº</li><li>èŠ‚ç‚¹è¢«å…³æœº</li><li>ç½‘ç»œä¸é€š</li></ul><h3 id="_6ã€pod-ä¸€ç›´å¤„äº-error-çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#_6ã€pod-ä¸€ç›´å¤„äº-error-çŠ¶æ€"><span>6ã€Pod ä¸€ç›´å¤„äº Error çŠ¶æ€</span></a></h3><p>é€šå¸¸å¤„äº Error çŠ¶æ€è¯´æ˜ Pod å¯åŠ¨è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ã€‚å¸¸è§çš„åŸå› åŒ…æ‹¬ï¼š</p><ul><li>ä¾èµ–çš„ ConfigMapã€Secret æˆ–è€… PV ç­‰ä¸å­˜åœ¨</li><li>è¯·æ±‚çš„èµ„æºè¶…è¿‡äº†ç®¡ç†å‘˜è®¾ç½®çš„é™åˆ¶ï¼Œæ¯”å¦‚è¶…è¿‡äº† LimitRange ç­‰</li><li>è¿åé›†ç¾¤çš„å®‰å…¨ç­–ç•¥ï¼Œæ¯”å¦‚è¿åäº† PodSecurityPolicy ç­‰</li><li>å®¹å™¨æ— æƒæ“ä½œé›†ç¾¤å†…çš„èµ„æºï¼Œæ¯”å¦‚å¼€å¯ RBAC åï¼Œéœ€è¦ä¸º ServiceAccount é…ç½®è§’è‰²ç»‘å®š</li></ul><h3 id="_7ã€pod-ä¸€ç›´å¤„äº-imagepullbackoff-çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#_7ã€pod-ä¸€ç›´å¤„äº-imagepullbackoff-çŠ¶æ€"><span>7ã€Pod ä¸€ç›´å¤„äº ImagePullBackOff çŠ¶æ€</span></a></h3><ul><li><strong>http ç±»å‹ registryï¼Œåœ°å€æœªåŠ å…¥åˆ° insecure- registry</strong></li></ul><hr><p>dockerd é»˜è®¤ä» https ç±»å‹çš„ registry æ‹‰å–é•œåƒï¼Œå¦‚æœä½¿ç”¨ https ç±»å‹çš„ registryï¼Œåˆ™ å¿…é¡»å°†å®ƒæ·»åŠ åˆ° insecure-registry å‚æ•°ä¸­ï¼Œç„¶åé‡å¯æˆ– reload dockerd ç”Ÿæ•ˆã€‚</p><ul><li><strong>https è‡ªç­¾å‘ç±»å‹ resitryï¼Œæ²¡æœ‰ç»™èŠ‚ç‚¹æ·»åŠ  ca è¯ä¹¦</strong></li></ul><hr><p>å¦‚æœ registry æ˜¯ https ç±»å‹ï¼Œä½†è¯ä¹¦æ˜¯è‡ªç­¾å‘çš„ï¼Œdockerd ä¼šæ ¡éªŒ registry çš„è¯ä¹¦ï¼Œæ ¡éªŒ æˆåŠŸæ‰èƒ½æ­£å¸¸ä½¿ç”¨é•œåƒä»“åº“ï¼Œè¦æƒ³æ ¡éªŒæˆåŠŸå°±éœ€è¦å°† registry çš„ ca è¯ä¹¦æ”¾ç½®åˆ°<br> /etc/docker/certs.d/<a href="registry:port" target="_blank" rel="noopener noreferrer">registry:port</a>/ca.crt ä½ç½®</p><ul><li><strong>ç§æœ‰é•œåƒä»“åº“è®¤è¯å¤±è´¥</strong></li></ul><hr><p>å¦‚æœ registry éœ€è¦è®¤è¯ï¼Œä½†æ˜¯ Pod æ²¡æœ‰é…ç½® imagePullSecretï¼Œé…ç½®çš„ Secret ä¸å­˜åœ¨æˆ–è€… æœ‰è¯¯éƒ½ä¼šè®¤è¯å¤±è´¥ã€‚</p><ul><li><strong>é•œåƒæ–‡ä»¶æŸå</strong></li></ul><hr><p>å¦‚æœ push çš„é•œåƒæ–‡ä»¶æŸåäº†ï¼Œä¸‹è½½ä¸‹æ¥ä¹Ÿç”¨ä¸äº†ï¼Œéœ€è¦é‡æ–° push é•œåƒæ–‡ä»¶ã€‚</p><ul><li><strong>é•œåƒæ‹‰å–è¶…æ—¶</strong></li></ul><hr><p>å¦‚æœèŠ‚ç‚¹ä¸Šæ–°èµ·çš„ Pod å¤ªå¤šå°±ä¼šæœ‰è®¸å¤šå¯èƒ½ä¼šé€ æˆå®¹å™¨é•œåƒä¸‹è½½æ’é˜Ÿï¼Œå¦‚æœå‰é¢æœ‰è®¸å¤šå¤§é•œåƒéœ€è¦ä¸‹ è½½å¾ˆé•¿æ—¶é—´ï¼Œåé¢æ’é˜Ÿçš„ Pod å°±ä¼šæŠ¥æ‹‰å–è¶…æ—¶ã€‚<br> kubelet é»˜è®¤ä¸²è¡Œä¸‹è½½é•œåƒ:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>--serialize-image-pulls Pull images one at a time. We recommend *not* changing the default value on nodes that run docker daemon with version &lt; 1.9 or an Aufs storage backend. Issue #10959 has more details. (default true)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ä¹Ÿå¯ä»¥å¼€å¯å¹¶è¡Œä¸‹è½½å¹¶æ§åˆ¶å¹¶å‘:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>--registry-qps int32 If &gt; 0, limit registry pull QPS to this value. If 0, unlimited. (default 5)</span></span>
<span class="line"><span>--registry-burst int32 Maximum size of a bursty pulls, temporarily allows pulls to burst to this number, while still not exceeding registry-qps. Only used if --registry-qps &gt; 0 (default 10)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>é•œåƒä¸å­˜åœ¨</strong></li></ul><hr><p>kubeletæ—¥å¿—ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>PullImage &quot;imroc/test:v0.2&quot; from image service failed: rpc error: code = Unknown desc = Error response from daemon: manifest for imroc/test:v0.2 not found</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_8ã€pod-å¥åº·æ£€æŸ¥å¤±è´¥" tabindex="-1"><a class="header-anchor" href="#_8ã€pod-å¥åº·æ£€æŸ¥å¤±è´¥"><span>8ã€Pod å¥åº·æ£€æŸ¥å¤±è´¥</span></a></h3><ul><li>Kubernetes å¥åº·æ£€æŸ¥åŒ…å«å°±ç»ªæ£€æŸ¥(readinessProbe)å’Œå­˜æ´»æ£€æŸ¥(livenessProbe)</li><li>pod å¦‚æœå°±ç»ªæ£€æŸ¥å¤±è´¥ä¼šå°†æ­¤ pod ip ä» service ä¸­æ‘˜é™¤ï¼Œé€šè¿‡ service è®¿é—®ï¼Œæµé‡å°† ä¸ä¼šè¢«è½¬å‘ç»™å°±ç»ªæ£€æŸ¥å¤±è´¥çš„ pod</li><li>pod å¦‚æœå­˜æ´»æ£€æŸ¥å¤±è´¥ï¼Œkubelet å°†ä¼šæ€æ­»å®¹å™¨å¹¶å°è¯•é‡å¯</li></ul><p>å¥åº·æ£€æŸ¥å¤±è´¥çš„å¯èƒ½åŸå› æœ‰å¤šç§ï¼Œé™¤äº†ä¸šåŠ¡ç¨‹åºBUGå¯¼è‡´ä¸èƒ½å“åº”å¥åº·æ£€æŸ¥å¯¼è‡´ unhealthyï¼Œè¿˜èƒ½æœ‰ æœ‰å…¶å®ƒåŸå› ï¼Œä¸‹é¢æˆ‘ä»¬æ¥é€ä¸ªæ’æŸ¥ã€‚</p><ul><li><strong>å¥åº·æ£€æŸ¥é…ç½®ä¸åˆç†</strong></li></ul><hr><p>initialDelaySeconds å¤ªçŸ­ï¼Œå®¹å™¨å¯åŠ¨æ…¢ï¼Œå¯¼è‡´å®¹å™¨è¿˜æ²¡å®Œå…¨å¯åŠ¨å°±å¼€å§‹æ¢æµ‹ï¼Œå¦‚æœ successThreshold æ˜¯é»˜è®¤å€¼ 1ï¼Œæ£€æŸ¥å¤±è´¥ä¸€æ¬¡å°±ä¼šè¢« killï¼Œç„¶å pod ä¸€ç›´è¿™æ ·è¢« kill é‡ å¯ã€‚</p><ul><li><strong>èŠ‚ç‚¹è´Ÿè½½è¿‡é«˜</strong></li></ul><hr><p>cpu å ç”¨é«˜ï¼ˆæ¯”å¦‚è·‘æ»¡ï¼‰ä¼šå¯¼è‡´è¿›ç¨‹æ— æ³•æ­£å¸¸å‘åŒ…æ”¶åŒ…ï¼Œé€šå¸¸ä¼š timeoutï¼Œå¯¼è‡´ kubelet è®¤ä¸º pod ä¸å¥åº·</p><ul><li><strong>å®¹å™¨è¿›ç¨‹è¢«æœ¨é©¬è¿›ç¨‹æ€æ­»</strong></li></ul><hr><ul><li><strong>å®¹å™¨å†…è¿›ç¨‹ç«¯å£ç›‘å¬æŒ‚æ‰</strong></li></ul><hr><p>ä½¿ç”¨ netstat -tunlp æ£€æŸ¥ç«¯å£ç›‘å¬æ˜¯å¦è¿˜åœ¨ï¼Œå¦‚æœä¸åœ¨äº†ï¼ŒæŠ“åŒ…å¯ä»¥çœ‹åˆ°ä¼šç›´æ¥ reset æ‰å¥ åº·æ£€æŸ¥æ¢æµ‹çš„è¿æ¥:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>20:15:17.890996 IP 172.16.2.1.38074 &gt; 172.16.2.23.8888: Flags [S], seq 96880261, win 14600, options [mss 1424,nop,nop,sackOK,nop,wscale 7], length 0</span></span>
<span class="line"><span>20:15:17.891021 IP 172.16.2.23.8888 &gt; 172.16.2.1.38074: Flags [R.], seq 0, ack 96880262, win 0, length 0</span></span>
<span class="line"><span>20:15:17.906744 IP 10.0.0.16.54132 &gt; 172.16.2.23.8888: Flags [S], seq 1207014342, win 14600, options [mss 1424,nop,nop,sackOK,nop,wscale 7], length 0</span></span>
<span class="line"><span>20:15:17.906766 IP 172.16.2.23.8888 &gt; 10.0.0.16.54132: Flags [R.], seq 0, ack 1207014343, win 0, length 0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿æ¥å¼‚å¸¸ï¼Œä»è€Œå¥åº·æ£€æŸ¥å¤±è´¥ã€‚å‘ç”Ÿè¿™ç§æƒ…å†µçš„åŸå› å¯èƒ½åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šå¯åŠ¨äº†å¤šä¸ªä½¿ç”¨ hostNetwork ç›‘å¬ç›¸åŒå®¿ä¸»æœºç«¯å£çš„ Podï¼Œåªä¼šæœ‰ä¸€ä¸ª Pod ç›‘å¬æˆåŠŸï¼Œä½†ç›‘å¬å¤±è´¥çš„ Pod çš„ ä¸šåŠ¡é€»è¾‘å…è®¸äº†ç›‘å¬å¤±è´¥ï¼Œå¹¶æ²¡æœ‰é€€å‡ºï¼ŒPod åˆé…äº†å¥åº·æ£€æŸ¥ï¼Œkubelet å°±ä¼šç»™ Pod å‘é€å¥åº·æ£€æŸ¥ æ¢æµ‹æŠ¥æ–‡ï¼Œä½† Pod ç”±äºæ²¡æœ‰ç›‘å¬æ‰€ä»¥å°±ä¼šå¥åº·æ£€æŸ¥å¤±è´¥ã€‚</p><ul><li><strong>SYN backlog è®¾ç½®è¿‡å°</strong></li></ul><hr><p>SYN backlog å¤§å°å³ SYN é˜Ÿåˆ—å¤§å°ï¼Œå¦‚æœçŸ­æ—¶é—´å†…æ–°å»ºè¿æ¥æ¯”è¾ƒå¤šï¼Œè€Œ SYN backlog è®¾ç½®å¤ª å°ï¼Œå°±ä¼šå¯¼è‡´æ–°å»ºè¿æ¥å¤±è´¥ï¼Œé€šè¿‡ netstat -s | grep TCPBacklogDropå¯ä»¥çœ‹åˆ°æœ‰å¤šå°‘æ˜¯å› ä¸º backlog æ»¡äº†å¯¼è‡´ä¸¢å¼ƒçš„æ–°è¿æ¥ã€‚<br> å¦‚æœç¡®è®¤æ˜¯ backlog æ»¡äº†å¯¼è‡´çš„ä¸¢åŒ…ï¼Œå»ºè®®è°ƒé«˜ backlog çš„å€¼ï¼Œå†…æ ¸å‚æ•°ä¸º net.ipv4.tcp_max_syn_backlog ã€‚</p><ul><li><strong>å®¹å™¨è¿›ç¨‹ä¸»åŠ¨é€€å‡º</strong></li></ul><hr><p>å®¹å™¨è¿›ç¨‹å¦‚æœæ˜¯è‡ªå·±ä¸»åŠ¨é€€å‡º(ä¸æ˜¯è¢«å¤–ç•Œä¸­æ–­æ€æ­»)ï¼Œé€€å‡ºçŠ¶æ€ç ä¸€èˆ¬åœ¨ 0-128 ä¹‹é—´ï¼Œæ ¹æ®çº¦å®šï¼Œæ­£ å¸¸é€€å‡ºæ—¶çŠ¶æ€ç ä¸º 0ï¼Œ1-127 è¯´æ˜æ˜¯ç¨‹åºå‘ç”Ÿå¼‚å¸¸ï¼Œä¸»åŠ¨é€€å‡ºäº†ï¼Œæ¯”å¦‚æ£€æµ‹åˆ°å¯åŠ¨çš„å‚æ•°å’Œæ¡ä»¶ä¸æ»¡ è¶³è¦æ±‚ï¼Œæˆ–è€…è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿ panic ä½†æ²¡æœ‰æ•è·å¤„ç†å¯¼è‡´ç¨‹åºé€€å‡ºã€‚é™¤äº†å¯èƒ½æ˜¯ä¸šåŠ¡ç¨‹åº BUGï¼Œè¿˜ æœ‰å…¶å®ƒè®¸å¤šå¯èƒ½åŸå› ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸€ä¸€åˆ—ä¸¾ä¸‹ã€‚</p><ul><li><strong>DNS æ— æ³•è§£æ</strong><br> å¯èƒ½ç¨‹åºä¾èµ– é›†ç¾¤ DNS æœåŠ¡ï¼Œæ¯”å¦‚å¯åŠ¨æ—¶è¿æ¥æ•°æ®åº“ï¼Œæ•°æ®åº“ä½¿ç”¨ service åç§°æˆ–å¤–éƒ¨åŸŸåéƒ½éœ€ è¦ DNS è§£æï¼Œå¦‚æœè§£æå¤±è´¥ç¨‹åºå°†æŠ¥é”™å¹¶ä¸»åŠ¨é€€å‡ºã€‚è§£æå¤±è´¥çš„å¯èƒ½åŸå› :1ã€é›†ç¾¤ç½‘ç»œæœ‰é—®é¢˜ï¼ŒPod è¿ä¸ä¸Šé›†ç¾¤ DNS æœåŠ¡<br> 2ã€é›†ç¾¤ DNS æœåŠ¡æŒ‚äº†ï¼Œæ— æ³•å“åº”è§£æè¯·æ±‚<br> 3ã€Service æˆ–åŸŸååœ°å€é…ç½®æœ‰è¯¯ï¼Œæœ¬èº«æ˜¯æ— æ³•è§£æçš„åœ°å€</li><li><strong>ç¨‹åºé…ç½®æœ‰è¯¯</strong><br> 1ã€é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼Œç¨‹åºå¯åŠ¨è§£æé…ç½®å¤±è´¥æŠ¥é”™é€€å‡º<br> 2ã€é…ç½®å†…å®¹ä¸ç¬¦åˆè§„èŒƒï¼Œæ¯”å¦‚é…ç½®ä¸­æŸä¸ªå­—æ®µæ˜¯å¿…é€‰ä½†æ²¡æœ‰å¡«å†™ï¼Œé…ç½®æ ¡éªŒä¸é€šè¿‡ï¼Œç¨‹åºæŠ¥é”™ä¸»åŠ¨ é€€å‡º</li></ul><p>å‚è€ƒï¼š<br><a href="https://blog.csdn.net/qq_31055683/article/details/126970831" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qq_31055683/article/details/126970831</a></p></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/justdoitMr/blogs//edit/master/themeHope/ContainerCloud/k8s/act_none_podå¼‚å¸¸çŠ¶æ€æ’æŸ¥.md" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 2284609302@qq.com">ä¸çˆ±æ‰“ä»£ç çš„ç¨‹åºå‘˜</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/ContainerCloud/k8s/act_one_k8s%E4%B8%AD%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%8E%9F%E7%90%86.md.html" aria-label="1ã€K8sä¸­è´Ÿè½½å‡è¡¡åŸç†"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="font-icon icon iconfont icon-file" style=""></span>1ã€K8sä¸­è´Ÿè½½å‡è¡¡åŸç†</div></a><a class="route-link auto-link next" href="/ContainerCloud/k8s/act_two_k8s%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0.html" aria-label="3ã€K8SåŸºç¡€å­¦ä¹ "><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">3ã€K8SåŸºç¡€å­¦ä¹ <span class="font-icon icon iconfont icon-file" style=""></span></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">äº‘åŸç”Ÿ</div><div class="vp-copyright">bugcode</div></footer></div><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.9637422e.js" defer></script><script src="/assets/js/9547.c8ff98a9.js" defer></script><script src="/assets/js/app.03f81d61.js" defer></script>
  </body>
</html>
